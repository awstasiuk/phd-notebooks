; delay definitions
define delay tau1
"tau1=d3*(1+cnst1+2*cnst2)-p1/2"
define delay tau2
"tau2=d3*(1-cnst2)-p1"
define delay tau3 
"tau3 = 2*d3*(1-cnst2)-p1"
define delay tau1p 
"tau1p = d3*2*(1-cnst1+2*cnst2)-p1"
"l1=0"  ; start the evolution counter at 0

1   ze

2
d1 rpp1 rpp2 rpp3 rpp4
100u pl2:f2
(p1 ph0):f2
1.5u
4
tau1
(p1 ph1^):f2
tau2
(p1 ph2^):f2
tau3
(p1 ph3^):f2
tau2
(p1 ph4^):f2
tau1p
(p1 ph1^):f2
tau2
(p1 ph2^):f2
tau3
(p1 ph3^):f2
tau2
(p1 ph4^):f2
tau1

lo to 4 times l1
(p1 ph5):f2
1.5u
1m
(p1 ph30):f2

go=2 ph31
1m wr #0 if #0

iu1
iu1

25m ip5*160

lo to 2 times td1

exit
ph0 = (360) 90 270

ph1 = (360) 10 50 270 310 170 210 70 110 330 10 230 270 130 170 30 70 290 330 190 230 90 130 350 30 250 290 150 190 50 90 310 350 210 250 110 150 10 50 270 310 170 210 70 110 330 10 230 270 130 170 30 70 290 330 190 230 90 130 350 30 250 290 150 190 50 90 310 350 210 250 110 150 10 50 270 310 170 210 70 110
ph2 = (360) 110 150 10 50 270 310 170 210 70 110 330 10 230 270 130 170 30 70 290 330 190 230 90 130 350 30 250 290 150 190 50 90 310 350 210 250 110 150 10 50 270 310 170 210 70 110 330 10 230 270 130 170 30 70 290 330 190 230 90 130 350 30 250 290 150 190 50 90 310 350 210 250 110 150 10 50 270 310 170 210
ph3 = (360) 120 160 20 60 280 320 180 220 80 120 340 20 240 280 140 180 40 80 300 340 200 240 100 140 0 40 260 300 160 200 60 100 320 0 220 260 120 160 20 60 280 320 180 220 80 120 340 20 240 280 140 180 40 80 300 340 200 240 100 140 0 40 260 300 160 200 60 100 320 0 220 260 120 160 20 60 280 320 180 220
ph4 = (360) 40 80 300 340 200 240 100 140 0 40 260 300 160 200 60 100 320 0 220 260 120 160 20 60 280 320 180 220 80 120 340 20 240 280 140 180 40 80 300 340 200 240 100 140 0 40 260 300 160 200 60 100 320 0 220 260 120 160 20 60 280 320 180 220 80 120 340 20 240 280 140 180 40 80 300 340 200 240 100 140

ph5 = (360) 280 100

ph30 = (360) 90 270
ph31 = 0 2