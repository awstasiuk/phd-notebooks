; delay definitions
define delay delay0
"delay0=(d20-p1)/2"
define delay delay1
"delay1=d20-p1"
define delay tau1
"tau1=d3*(1+cnst1+2*cnst2)-p1/2"
define delay tau2
"tau2=d3*(1-cnst2)-p1"
define delay tau3 
"tau3 = 2*d3*(1-cnst2)-p1"
define delay tau1p 
"tau1p = d3*2*(1-cnst1+2*cnst2)-p1"
"l1=5"  ; start the evolution counter at 0

1   ze

2
d1 rpp1 rpp2 rpp3 rpp4 rpp6 rpp7 rpp8 rpp9 rpp11 rpp12 rpp13 rpp14
100u pl2:f2
(p1 ph0):f2
1.5u

3
delay0
(p1 ph1^):f2
delay1
(p1 ph2^):f2
delay1
(p1 ph3^):f2
delay1
(p1 ph4^):f2
delay0

lo to 3 times 21

(p1 ph5):f2
1.5u
4
tau1
(p1 ph6^):f2
tau2
(p1 ph7^):f2
tau3
(p1 ph8^):f2
tau2
(p1 ph9^):f2
tau1p
(p1 ph6^):f2
tau2
(p1 ph7^):f2
tau3
(p1 ph8^):f2
tau2
(p1 ph9^):f2
tau1

lo to 4 times l1
(p1 ph10):f2
1.5u

5
delay0
(p1 ph11^):f2
delay1
(p1 ph12^):f2
delay1
(p1 ph13^):f2
delay1
(p1 ph14^):f2
delay0

lo to 5 times 21

(p1 ph15):f2
1.5u
1m
(p1 ph29):f2
20u
(p1 ph30):f2

go=2 ph31
1m wr #0 if #0

iu1
iu1

25m ip10*0
25m ip11*0
25m ip12*0
25m ip13*0
25m ip14*0
25m ip15*0

lo to 2 times td1

exit
ph0 = (360) 90 90 270 270 0 0 180 180

ph1 = (360) 90 0 90 90 0 90 90 0 90 90 0 90 90 0 90 90 0 90 90 0 90
ph2 = (360) 0 0 180 0 0 180 0 0 180 0 0 180 0 0 180 0 0 180 0 0 180
ph3 = (360) 0 180 180 0 180 180 0 180 180 0 180 180 0 180 180 0 180 180 0 180 180
ph4 = (360) 270 180 270 270 180 270 270 180 270 270 180 270 270 180 270 270 180 270 270 180 270

ph5 = (360) 0 0 180 180 270 270 90 90

ph6 = (360) 0 0 180 180 0 0 180 180 0 0 180 180 0 0 180 180 0 0 180 180
ph7 = (360) 90 90 270 270 90 90 270 270 90 90 270 270 90 90 270 270 90 90 270 270
ph8 = (360) 90 90 270 270 90 90 270 270 90 90 270 270 90 90 270 270 90 90 270 270
ph9 = (360) 0 0 180 180 0 0 180 180 0 0 180 180 0 0 180 180 0 0 180 180

ph10 = (360) 0 0 0 0 0 0 0 0 180 180 180 180 180 180 180 180

ph11 = (360) 90 0 90 90 0 90 90 0 90 90 0 90 90 0 90 90 0 90 90 0 90
ph12 = (360) 0 0 180 0 0 180 0 0 180 0 0 180 0 0 180 0 0 180 0 0 180
ph13 = (360) 0 180 180 0 180 180 0 180 180 0 180 180 0 180 180 0 180 180 0 180 180
ph14 = (360) 270 180 270 270 180 270 270 180 270 270 180 270 270 180 270 270 180 270 270 180 270

ph15 = (360) 270 270 270 270 270 270 270 270 90 90 90 90 90 90 90 90

ph29 = (360) 0 180
ph30 = (360) 90 270
ph31 = 0 2